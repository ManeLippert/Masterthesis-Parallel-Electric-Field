% 4. Simulations and Benchmarks
\addtocontents{toc}{\protect\pagebreak[4]}
\chapter{Mitigation of the Cancellation Problem in Local Gyrokinetic Simulations}
\label{chap:methods}

\thispagestyle{empty}
\newpage

In this chapter the established mitigation technique from Chapter \ref{sub:fieldEpar} will be implemented into local (flux-tube) version of the Gyrokinetic Workshop ({\gkw}). In this version GKW solves the Vlasov equation for the modified distribution function $g$ [Ch. \ref{sub:cancelProblem}], which could be done for the linear and the nonlinear version of the Vlasov equation. As coordinates {\gkw} uses the field aligned Hamada coordinates\cite{Hamada1962} with the coordinate set $\{s,~\psi,~\zeta,~\vpar,~\mu\}$. Here, $s$ parameterizes the length along the field lines, $\psi$ is the radial coordinate (normalized by $\rhoth$) and $\zeta$ represents approximately the binormal coordinate. In general {\gkw} calculates the solution of the Vlasov and field equations with a matrix vector multiplication. The solutions will be stored in the array \code{fdisi}, which contains the distribution $g$ and the fields $\Phi_1$, $\Apar$, $\Bpar$ and other "fields" und will be updated dynamically for each timestep. For that, multiple matrices will be defined which will only act on specific elements in \code{fdisi}. These matricies contains terms which appear before a calculated quantity. To evolve the distribution functiun in time a simple Runge Kutta scheme will be used. Additionally, in {\gkw} there a multiple diagnostics defined, each diagnostics computes and outputs a distinct physical quantity. \cite{GKWManual} To read more about the code {\gkw} the reader is referred to Ref. \citenum{Peeters2009A} or to the manual\cite{GKWManual}
\bigskip

For the implementation of the mitigation technique is seperated in three steps
\begin{itemize}
    \item[(1)] Implementation of Faraday's law into {\gkw},
    \item[(2)] Calculation of the gyrocenter distribution function $\df$ in the linear version of {\gkw} and
    \item[(3)] Calculation of the nonlinear terms with the gyrocenter distribution $\df$.
\end{itemize}

The reader is referred to the branch in bibucket\cite{FeatureEparBitbucket} for more in depth documentation on the process and implementation. The simulations were performed on the \code{emil}\cite{emil} cluster, the \code{festus}\cite{festus} cluster of the University Bayreuth or on one of the \code{btppx} machines of the TPV Chair.

\newpage